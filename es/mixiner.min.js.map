{"version":3,"sources":["mixiner.js"],"names":["VERSION","Mixins","constructor","collection","add","push","setParent","parent","has","indexOf","getProto","Object","getPrototypeOf","__proto__","getOwnPropsKeys","getOwnPropertyNames","getOwnPropertySymbols","concat","defineProps","ignoreProtoProps","ignoreStaticProps","ignoreInstanceProps","length","resolve","target","mixin","options","type","propertyName","define","prototype","hasOwnProperty","assignClasses","call","_mixins_","defineProperty","value","configurable","writable","Array","isArray","forEach","assign","keys","mixIn","_mixinInstance_","mixedBy","instanceOf","getOwnPropertyDescriptor","mixiner","mix","extend","config","default","resolveConflict","split","map","parseInt"],"mappings":"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","file":"mixiner.min.js","sourcesContent":["/**\n * @license\n * Mixiner <https://shvabuk.github.io/mixiner>\n * Released under MIT license <https://shvabuk.github.io/mixiner/LICENSE.txt>\n * Copyright Shvab Ostap\n */\n\n;\"use strict\";\nconst VERSION = '1.0.5';\n// storage of mixins, defined in constructor._mixins_\nexport class Mixins {\n    constructor() {\n        this.collection = [];\n        this.VERSION = VERSION;\n    }\n    add(mixin) {\n        this.collection.push(mixin);\n    }\n    setParent(mixins) {\n        this.parent = mixins;\n    }\n    has(mixin) {\n        return (this.collection.indexOf(mixin) > -1 ||\n            (typeof this.parent !== 'undefined' && this.parent.has(mixin)));\n    }\n}\n// get object prototype\nconst getProto = Object.getPrototypeOf || (obj => obj.__proto__);\n// get props names, used in mixin\nfunction getOwnPropsKeys(target) {\n    const keys = Object.getOwnPropertyNames(target);\n    if (typeof Object.getOwnPropertySymbols !== 'undefined') {\n        return [].concat(keys, Object.getOwnPropertySymbols(target));\n    }\n    return keys;\n}\n// define mixin (static, prototype or instance) properties\nfunction defineProps(target, mixin, options, type) {\n    const mixinNames = getOwnPropsKeys(mixin);\n    const targetNames = getOwnPropsKeys(target);\n    const ignore = type === 'proto'\n        ? options.ignoreProtoProps\n        : type === 'static' ? options.ignoreStaticProps : options.ignoreInstanceProps;\n    let i = mixinNames.length;\n    while (i--) {\n        // ignore props from ignorelist\n        if (ignore.indexOf(mixinNames[i]) > -1) {\n            continue;\n        }\n        // check conflicts\n        // custom resolve\n        if (targetNames.indexOf(mixinNames[i]) > -1) {\n            options.resolve({\n                target,\n                mixin,\n                options,\n                type,\n                propertyName: mixinNames[i],\n            });\n        }\n        else {\n            // default define\n            options.define(target, mixin, mixinNames[i]);\n        }\n    }\n}\n// wrapper according to https://github.com/airbnb/javascript#objects--prototype-builtins\nconst has = Object.prototype.hasOwnProperty;\n// define static and prototype properties\nfunction assignClasses(target, mixin, options) {\n    // add mixins links\n    if (!has.call(target, '_mixins_')) {\n        const parentMixins = target._mixins_;\n        Object.defineProperty(target, '_mixins_', {\n            value: new Mixins(),\n            configurable: true,\n            writable: true,\n        });\n        if (typeof parentMixins !== 'undefined') {\n            target._mixins_.setParent(parentMixins);\n        }\n    }\n    // add mixined in mixin mixins\n    if (typeof mixin._mixins_ === 'object' && Array.isArray(mixin._mixins_.collection)) {\n        mixin._mixins_.collection.forEach((parentMixin) => assignClasses(target, parentMixin, options));\n    }\n    // copy prototype properties\n    defineProps(target.prototype, mixin.prototype, options, 'proto');\n    // copy constructor properties\n    defineProps(target, mixin, options, 'static');\n    target._mixins_.add(mixin);\n}\n// copy options properties, just primitive Object.assign polyfill for IE9\nfunction assign(target, source) {\n    const keys = Object.keys(source);\n    let i = keys.length;\n    while (i--) {\n        target[keys[i]] = source[keys[i]];\n    }\n    return target;\n}\n// mixin function\n// at this moment loop inside of constructor increse object creation speed\n// during V8 engine optimization\nfunction mixIn(options, mixins, parent) {\n    const len = mixins.length;\n    let target;\n    let i = -1;\n    if (typeof parent === 'undefined') {\n        target = class MixinsWrapper {\n            constructor() {\n                let j = -1;\n                // copy instance properties\n                // mixins[i].apply(this) does not work in ES2015+ classes\n                while (++j < len) {\n                    if (typeof mixins[j]._mixinInstance_ === 'undefined') {\n                        mixins[j]._mixinInstance_ = new mixins[j]();\n                    }\n                    defineProps(this, mixins[j]._mixinInstance_, options, 'instance');\n                }\n            }\n        };\n    }\n    else {\n        // ignore first mixin, it is parent class\n        target = class MixinsWrapper extends parent {\n            constructor(...args) {\n                const out = super(...args);\n                let j = -1;\n                // copy instance properties\n                // mixins[i].apply(this) does not work in ES2015+ classes\n                while (++j < len) {\n                    if (typeof mixins[j]._mixinInstance_ === 'undefined') {\n                        mixins[j]._mixinInstance_ = new mixins[j]();\n                    }\n                    defineProps(this, mixins[j]._mixinInstance_, options, 'instance');\n                }\n                return out;\n            }\n        };\n    }\n    while (++i < len) {\n        assignClasses(target, mixins[i], options);\n    }\n    return target;\n}\n// check mixin usage\nexport function mixedBy(instance, mixin) {\n    const ctor = getProto(instance).constructor;\n    if (typeof ctor._mixins_ === 'object' && typeof ctor._mixins_.has === 'function') {\n        return ctor._mixins_.has(mixin);\n    }\n    return false;\n}\n// check mixin usage and instanceof\nexport function instanceOf(instance, mixin) {\n    return mixedBy(instance, mixin) || instance instanceof mixin;\n}\nconst define = (target, mixin, propertyName) => {\n    Object.defineProperty(target, propertyName, Object.getOwnPropertyDescriptor(mixin, propertyName));\n};\n// main object\nconst mixiner = {\n    VERSION,\n    Mixins,\n    options,\n    mix,\n    extend,\n    mixedBy,\n    instanceOf,\n    config: {\n        define,\n        resolve: ({ target, mixin, /* options, type, */ propertyName }) => {\n            define(target, mixin, propertyName);\n        },\n        ignoreProtoProps: [\n            'constructor',\n            'apply',\n            'bind',\n            'call',\n            'isGenerator',\n            'toSource',\n            'toString',\n            '__proto__',\n        ],\n        ignoreStaticProps: [\n            'arguments',\n            'arity',\n            'caller',\n            'length',\n            'name',\n            'displayName',\n            'prototype',\n            '__proto__',\n            '_mixinInstance_',\n        ],\n        ignoreInstanceProps: ['__proto__'],\n    },\n};\nmixiner.default = mixiner; // set options for current mixining\nexport default mixiner;\nexport function options(options) {\n    const opts = assign(assign({}, mixiner.config), options);\n    return {\n        mix: function mix(...args) {\n            return mixIn(opts, args);\n        },\n        extend: function extend(parent, ...args) {\n            return mixIn(opts, args, parent);\n        },\n    };\n}\n// extends parent with mixins implementation\nexport function extend(parent, ...args) {\n    return mixIn(mixiner.config, args, parent);\n}\n// mixins implementation\nexport function mix(...args) {\n    return mixIn(mixiner.config, args);\n}\n// internal method, used for resolving conflicts in global scope (browser window etc.)\nmixiner.resolveConflict = (root) => {\n    const oldParts = root.mixiner.VERSION.split('.').map(parseInt);\n    const newParts = mixiner.VERSION.split('.').map(parseInt);\n    let i = -1;\n    while (++i < 3) {\n        if (newParts[i] > oldParts[i]) {\n            return mixiner;\n        }\n        else if (newParts[i] < oldParts[i]) {\n            return root.mixiner;\n        }\n    }\n    return root.mixiner;\n};\n\n\n"]}